(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))f(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&f(c)}).observe(document,{childList:!0,subtree:!0});function m(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function f(i){if(i.ep)return;i.ep=!0;const r=m(i);fetch(i.href,r)}})();const B=.8,w={width:1024,height:576};class M{constructor({position:a,imageSrc:m,scale:f=1,framesMax:i=1,offset:r={x:0,y:0},context:c}){this.position=a,this.height=150,this.width=40,this.image=new Image,this.image.src=m,this.scale=f,this.framesMax=i,this.framesCurrent=0,this.framesElapsed=0,this.framesHold=6,this.offset=r,this.context=c}draw(){this.context.drawImage(this.image,this.framesCurrent*(this.image.width/this.framesMax),0,this.image.width/this.framesMax,this.image.height,this.position.x-this.offset.x,this.position.y-this.offset.y,this.image.width/this.framesMax*this.scale,this.image.height*this.scale)}animateFrames(){this.framesElapsed++,this.framesElapsed%this.framesHold===0&&(this.framesCurrent<this.framesMax-1?this.framesCurrent++:this.framesCurrent=0)}update(){this.draw(),this.animateFrames()}}class b extends M{constructor({position:a,velocity:m,color:f,imageSrc:i,scale:r=1,framesMax:c=1,offset:H={x:0,y:0},sprites:d,attackBox:k={offset:{},width:void 0,height:void 0},context:j,canvasHeight:L}){super({position:a,imageSrc:i,scale:r,framesMax:c,offset:H,context:j}),this.velocity=m,this.height=150,this.width=40,this.color=f,this.attackBox={position:{x:this.position.x,y:this.position.y},width:k.width,height:k.height,offset:k.offset},this.isAttacking=!1,this.health=100,this.framesCurrent=0,this.framesElapsed=0,this.framesHold=6,this.sprites=d,this.dead=!1,this.canvasHeight=L;for(const y in this.sprites)d[y].image=new Image,d[y].image.src=d[y].imageSrc}update(){this.draw(),this.dead||this.animateFrames(),this.position.y+=this.velocity.y,this.position.x+=this.velocity.x,this.attackBox.position.x=this.position.x+this.attackBox.offset.x,this.attackBox.position.y=this.position.y+this.attackBox.offset.y,this.position.y+this.height+this.velocity.y>=this.canvasHeight?(this.velocity.y=0,this.position.y=this.canvasHeight-this.height):this.velocity.y+=B}attack(){this.switchSprite("attack1"),this.isAttacking=!0}takeHit(){this.health-=20,this.health<=0?this.switchSprite("death"):this.switchSprite("takeHit")}switchSprite(a){if(this.image===this.sprites.death.image){this.framesCurrent===this.sprites.death.framesMax-1&&(this.dead=!0);return}if(!(this.image===this.sprites.attack1.image&&this.framesCurrent<this.sprites.attack1.framesMax-1||this.image===this.sprites.takeHit.image&&this.framesCurrent<this.sprites.takeHit.framesMax-1))switch(a){case"idle":this.image!==this.sprites.idle.image&&(this.image=this.sprites.idle.image,this.framesMax=this.sprites.idle.framesMax);break;case"run":this.image!==this.sprites.run.image&&(this.image=this.sprites.run.image,this.framesMax=this.sprites.run.framesMax,this.framesCurrent=0);break;case"jump":this.image!==this.sprites.jump.image&&(this.image=this.sprites.jump.image,this.framesMax=this.sprites.jump.framesMax,this.framesCurrent=0);break;case"fall":this.image!==this.sprites.fall.image&&(this.image=this.sprites.fall.image,this.framesMax=this.sprites.fall.framesMax,this.framesCurrent=0);break;case"attack1":this.image!==this.sprites.attack1.image&&(this.image=this.sprites.attack1.image,this.framesMax=this.sprites.attack1.framesMax,this.framesCurrent=0);break;case"takeHit":this.image!==this.sprites.takeHit.image&&(this.image=this.sprites.takeHit.image,this.framesMax=this.sprites.takeHit.framesMax,this.framesCurrent=0);break;case"death":this.image!==this.sprites.death.image&&(this.image=this.sprites.death.image,this.framesMax=this.sprites.death.framesMax,this.framesCurrent=0);break}}}function S({rect1:s,rect2:a}){return s.attackBox.position.x+s.attackBox.width>a.position.x&&s.attackBox.position.x<=a.position.x+a.width&&s.attackBox.position.y+s.attackBox.height>=a.position.y&&s.attackBox.position.y<=a.position.y+a.height}function v(s){s.position.y<80&&(s.velocity.y=5),s.position.x<=0&&(s.velocity.x=1),s.position.x+s.width>=canvas.width&&(s.velocity.x=-1)}const h=document.querySelector("canvas"),p=h.getContext("2d");h.width=w.width;h.height=w.height;console.log("Canvas setup complete:",w);p.fillRect(0,0,h.width,h.height);const I=new M({position:{x:0,y:0},imageSrc:"/assets/background.png"}),E=new M({position:{x:600,y:128},imageSrc:"/assets/shop.png",scale:2.75,framesMax:6}),e=new b({position:{x:0,y:0},velocity:{x:0,y:10},color:"orange",offset:{x:0,y:0},imageSrc:"/assets/samuraiMack/Idle.png",scale:2.5,framesMax:8,offset:{x:215,y:250},sprites:{idle:{imageSrc:"/assets/samuraiMack/Idle.png",framesMax:8},run:{imageSrc:"/assets/samuraiMack/Run.png",framesMax:8},jump:{imageSrc:"/assets/samuraiMack/Jump.png",framesMax:2},fall:{imageSrc:"/assets/samuraiMack/Fall.png",framesMax:2},attack1:{imageSrc:"/assets/samuraiMack/Attack1.png",framesMax:6},attack2:{imageSrc:"/assets/samuraiMack/Attack2.png",framesMax:6},takeHit:{imageSrc:"/assets/samuraiMack/White.png",framesMax:4},death:{imageSrc:"/assets/samuraiMack/Death.png",framesMax:6}},attackBox:{offset:{x:80,y:-50},width:150,height:50}}),t=new b({position:{x:600,y:0},velocity:{x:0,y:0},color:"red",offset:{x:-160,y:0},imageSrc:"/assets/kenji/Idle.png",scale:2.5,framesMax:4,offset:{x:215,y:265},sprites:{idle:{imageSrc:"/assets/kenji/Idle.png",framesMax:4},run:{imageSrc:"/assets/kenji/Run.png",framesMax:8},jump:{imageSrc:"/assets/kenji/Jump.png",framesMax:2},fall:{imageSrc:"/assets/kenji/Fall.png",framesMax:2},attack1:{imageSrc:"/assets/kenji/Attack1.png",framesMax:4},attack2:{imageSrc:"/assets/kenji/Attack2.png",framesMax:4},takeHit:{imageSrc:"/assets/kenji/Takehit.png",framesMax:3},death:{imageSrc:"/assets/kenji/Death.png",framesMax:7}},attackBox:{offset:{x:-150,y:-50},width:150,height:50}});let g,u;const n={a:{pressed:!1},d:{pressed:!1},w:{pressed:!1}},o={a:{pressed:!1},d:{pressed:!1},w:{pressed:!1}};let x,l=60;function A(){l>0&&(x=setTimeout(A,1e3),l--,document.querySelector("#timer").innerHTML=l,console.log(`Timer: ${l}`)),l===0&&(console.log("Timer ended! Determining winner..."),determineWinner({rect1:e,rect2:t,timer:x})),(t.health<=0||e.health<=0)&&(console.log("One fighter has no health! Determining winner..."),determineWinner({rect1:e,rect2:t,timerID:x}))}A();function C(){window.requestAnimationFrame(C),p.fillStyle="black",p.fillRect(0,0,h.width,h.height),I.update(),E.update(),p.fillStyle="rgba(255,255,255,0.1)",p.fillRect(0,0,h.width,h.height),e.update(),t.update(),e.velocity.x=0,n.a.pressed&&g==="a"?(e.velocity.x=-5,e.switchSprite("run")):n.d.pressed&&g==="d"?(e.velocity.x=5,e.switchSprite("run")):e.switchSprite("idle"),n.w.pressed&&(e.velocity.y=-15),e.velocity.y<0&&e.switchSprite("jump"),e.velocity.y>0&&e.switchSprite("fall"),t.velocity.x=0,o.a.pressed&&u==="a"?(t.velocity.x=-5,t.switchSprite("run")):o.d.pressed&&u==="d"?(t.velocity.x=5,t.switchSprite("run")):t.switchSprite("idle"),t.velocity.y<0&&t.switchSprite("jump"),t.velocity.y>0&&t.switchSprite("fall"),o.w.pressed&&(t.velocity.y=-15),S({rect1:e,rect2:t})&&e.isAttacking&&e.framesCurrent===4&&(t.takeHit(),e.isAttacking=!1,gsap.to("#enemyHealth",{width:t.health+"%"})),e.isAttacking&&e.framesCurrent===4&&(e.isAttacking=!1),S({rect1:t,rect2:e})&&t.isAttacking&&t.framesCurrent===2&&(e.takeHit(),t.isAttacking=!1,gsap.to("#playerHealth",{width:e.health+"%"})),t.isAttacking&&t.framesCurrent===2&&(t.isAttacking=!1),v(e),v(t)}C();window.addEventListener("keydown",s=>{if(!e.dead)switch(s.key){case"d":n.d.pressed=!0,g="d";break;case"a":n.a.pressed=!0,g="a";break;case"w":n.w.pressed=!0;break;case" ":e.attack();break}});window.addEventListener("keyup",s=>{switch(s.key){case"d":n.d.pressed=!1;break;case"a":n.a.pressed=!1;break;case"w":n.w.pressed=!1;break}});window.addEventListener("keydown",s=>{if(!t.dead)switch(s.key){case"ArrowRight":o.d.pressed=!0,u="d";break;case"ArrowLeft":o.a.pressed=!0,u="a";break;case"ArrowUp":o.w.pressed=!0;break;case"Shift":t.attack();break}});window.addEventListener("keyup",s=>{switch(s.key){case"ArrowRight":o.d.pressed=!1;break;case"ArrowLeft":o.a.pressed=!1;break;case"ArrowUp":o.w.pressed=!1;break}});
